# 台灣政府補習班資料抓取系統 (get_gov_data)

## 專案概述 (Project Overview)

這是一個自動化抓取台灣各縣市政府補習班資訊的 Python 專案。系統能夠從教育部全國短期補習班資訊管理系統 (https://bsb.kh.edu.tw/) 抓取各縣市補習班的詳細資訊，並整理成結構化的 CSV 檔案供後續分析使用。

## 產品需求文件 (PRD)

### 1. 產品目標 (Product Goals)

#### 1.1 主要目標

- **資料整合**: 自動化抓取全台 22 個縣市的補習班資訊
- **資料標準化**: 將不同縣市的資料格式統一，便於後續分析
- **即時更新**: 定期更新補習班開業、歇業資訊
- **資料品質**: 確保抓取資料的完整性和準確性

#### 1.2 次要目標

- 提供資料篩選功能（按日期、地區、類別等）
- 支援多種輸出格式（CSV、JSON 等）
- 建立資料變更追蹤機制

### 2. 功能需求 (Functional Requirements)

#### 2.1 核心功能

**F1. 補習班資訊抓取**

- 抓取補習班基本資訊：名稱、地址、電話、立案文號、立案日期
- 抓取補習班詳細資訊：電子郵件、補習班類別、地區縣市
- 支援全台 22 個縣市資料抓取

**F2. 資料篩選與處理**

- 按立案日期篩選（預設從 2024-08 開始）
- 資料去重和格式標準化
- 合併多個資料來源

**F3. 歇業補習班追蹤**

- 抓取各縣市歇業補習班清單
- 按時間範圍篩選（預設 2024-08 至 2024-10）
- 建立歇業補習班資料庫

**F4. 資料輸出**

- 生成各縣市獨立 CSV 檔案
- 生成全國合併 CSV 檔案
- 支援 UTF-8 編碼，確保中文正確顯示

#### 2.2 進階功能

**F5. 資料分析支援**

- 提供補習班統計資訊
- 支援按地區、類別、時間等維度分析
- 生成資料變更報告

### 3. 非功能需求 (Non-Functional Requirements)

#### 3.1 效能需求

- **響應時間**: 單一縣市資料抓取時間 < 30 秒
- **吞吐量**: 支援同時處理多個縣市資料
- **可用性**: 系統可用性 > 95%

#### 3.2 可靠性需求

- **資料完整性**: 確保抓取資料的完整性
- **錯誤處理**: 提供適當的錯誤處理機制
- **重試機制**: 網路異常時自動重試

#### 3.3 安全性需求

- **資料保護**: 確保抓取資料的安全性
- **存取控制**: 限制對敏感資料的存取
- **日誌記錄**: 記錄系統操作日誌

### 4. 技術架構 (Technical Architecture)

#### 4.1 技術棧

- **程式語言**: Python 3.x
- **網路請求**: requests
- **HTML 解析**: BeautifulSoup4
- **資料處理**: pandas
- **編碼處理**: UTF-8

#### 4.2 系統架構

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   資料來源      │    │   資料處理      │    │   資料輸出      │
│  bsb.kh.edu.tw │───▶│   Python 腳本   │───▶│   CSV 檔案      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

#### 4.3 資料流程

1. **初始化**: 建立 HTTP 會話，設定請求標頭
2. **縣市遍歷**: 依序處理 22 個縣市
3. **資料抓取**: 訪問各縣市資料頁面並解析 HTML
4. **資料處理**: 篩選、合併、格式化資料
5. **檔案輸出**: 生成 CSV 檔案

### 5. 資料模型 (Data Model)

#### 5.1 補習班基本資訊

| 欄位名稱       | 資料類型 | 說明                  |
| -------------- | -------- | --------------------- |
| 序號           | Integer  | 資料序號              |
| 補習班名稱     | String   | 補習班完整名稱        |
| 班址           | String   | 補習班地址            |
| 電話           | String   | 聯絡電話              |
| 立案文號       | String   | 政府立案文號          |
| 立案日期       | Date     | 立案日期 (YYYY-MM-DD) |
| 電子郵件       | String   | 聯絡電子郵件          |
| 短期補習班類別 | String   | 補習班類型            |
| 地區縣市       | String   | 所屬縣市              |

#### 5.2 補習班類別

- 文理類
- 資訊類
- 音樂、舞蹈類
- 美術、書法、攝影、美工設計、圍棋類
- 外語類

### 6. 使用方式 (Usage)

#### 6.1 環境需求

```bash
# 安裝必要套件
pip install requests pandas beautifulsoup4
```

#### 6.2 基本使用

```bash
# 執行基本資料抓取
python get.py

# 執行進階資料抓取（包含篩選和合併）
python city_m_all.py

# 執行歇業補習班資料抓取
python cancel_list.py
```

#### 6.3 輸出檔案

- `{縣市名稱}.csv`: 各縣市獨立資料檔案
- `combined_data.csv`: 全國合併資料檔案
- `all_counties_cancel_list.csv`: 歇業補習班清單

### 7. 配置參數 (Configuration)

#### 7.1 日期篩選參數

```python
# city_m_all.py
START_DATE = '2024-08'  # 篩選起始日期

# cancel_list.py
START_YEAR = 2024
START_MONTH = '08'
END_YEAR = 2024
END_MONTH = '10'
```

#### 7.2 縣市代碼對應

```python
county_list = {
    "台北市": 20, "新北市": 21, "桃園市": 33, "台中市": 42,
    "台南市": 62, "高雄市": 70, "基隆市": 24, "新竹市": 35,
    # ... 其他縣市
}
```

### 8. 錯誤處理 (Error Handling)

#### 8.1 常見錯誤

- **網路連線錯誤**: 自動重試機制
- **資料格式錯誤**: 跳過異常資料，記錄錯誤日誌
- **網站結構變更**: 更新解析邏輯

#### 8.2 錯誤日誌

系統會記錄以下錯誤：

- 無法連接到目標網站
- 資料解析失敗
- 檔案寫入錯誤

### 9. 維護與更新 (Maintenance)

#### 9.1 定期維護

- 每月更新縣市代碼對應表
- 檢查網站結構變更
- 更新請求標頭資訊

#### 9.2 版本控制

- 使用 Git 進行版本控制
- 記錄重要變更
- 維護變更日誌

### 10. 未來發展 (Future Development)

#### 10.1 短期目標

- 增加更多資料來源
- 改善資料品質檢查
- 新增資料視覺化功能

#### 10.2 長期目標

- 建立 Web 介面
- 提供 API 服務
- 整合機器學習分析

## 檔案說明 (File Description)

| 檔案名稱              | 說明                             |
| --------------------- | -------------------------------- |
| `get.py`            | 基本資料抓取腳本                 |
| `city_m_all.py`     | 進階資料抓取腳本（含篩選和合併） |
| `cancel_list.py`    | 歇業補習班資料抓取腳本           |
| `combined_data.csv` | 全國合併資料檔案                 |
| `6-8月倒掉的.csv`   | 6-8月歇業補習班清單              |
| `6月以後新開的.csv` | 6月以後新開業補習班清單          |
| `8-1021倒掉的.csv`  | 8-10月歇業補習班清單             |

## 授權條款 (License)

本專案僅供學習和研究使用，請遵守相關網站的使用條款和資料保護法規。

## 聯絡資訊 (Contact)

如有問題或建議，請透過 GitHub Issues 提出。

---

**注意**: 使用本系統時請遵守目標網站的使用條款，並確保資料使用符合相關法規要求。
